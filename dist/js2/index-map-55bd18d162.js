var map=new AMap.Map("container",{resizeEnable:!0,zoom:13}),driving=new AMap.Driving({map:map,panel:"panel"});function loadmap(){var a,e,t=$(".type-navs-active").index(".type-navs"),s=localStorage.getItem("area");if(s?$("#tip").html(s):(alert("请先选择所在地区"),window.location.href="select-area.html"),0==t){if(a=JSON.parse(sessionStorage.getItem("toaddress1")),e=JSON.parse(sessionStorage.getItem("toaddress2")),a&&e){var n=a.lng,i=a.lat,r=e.lng,o=e.lat;driving.search(new AMap.LngLat(n,i),new AMap.LngLat(r,o),function(){var a,e=$(".planTitle p").text().match(/\(([^)]*)\)/)[1],t=parseFloat(e);$("#distance").html(t);var s=JSON.parse(sessionStorage.getItem("Regulation1")),n=parseFloat(s.initialMoney),i=parseFloat(s.kmRange.split("-")[0]),r=parseFloat(s.kmRange.split("-")[1]),o=parseFloat(s.kmValuation),l=parseFloat(s.valuation);t<=i?a=n:i<t&&t<r?a=n+(t-i)*o:r<=t&&(a=n+(r-i)*o+(t-r)*l),console.log(a),$("#finish-price2").html(a.toFixed(2));var p=a+parseFloat($("#award3").text());$("#finish-price").html(p.toFixed(2))})}}else if(3==t&&(a=JSON.parse(sessionStorage.getItem("toaddress7")),e=JSON.parse(sessionStorage.getItem("toaddress8")),a&&e)){n=a.addressLng,i=a.addressLat,r=e.addressLng,o=e.addressLat;driving.search(new AMap.LngLat(n,i),new AMap.LngLat(r,o),function(){var a,e=$(".planTitle p").text().match(/\(([^)]*)\)/)[1],t=parseFloat(e),s=JSON.parse(sessionStorage.getItem("Regulation2")),n=parseFloat(s.initialMoney),i=parseFloat(s.kmRange.split("-")[0]),r=parseFloat(s.kmRange.split("-")[1]),o=parseFloat(s.kmValuation),l=parseFloat(s.valuation);$("#main4-distance").html(t),t<=i?a=n:i<t&&t<r?a=n+(t-i)*o:r<=t&&(a=n+(r-i)*o+(t-r)*l),$("#main4-reward").html(a);var p=a+parseFloat($("#main4-award").text());$("#main4-finish").html(p.toFixed(2))})}}setTimeout(function(){loadmap()},500);